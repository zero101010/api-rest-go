---
version: 1.2.0


environment:
  defaultServices:
    - name: "api-rest-go-helm"
            
services:
  - name: "api-rest-go-helm"
    kedaScaleToZero:
      type: http
      replicas:
        min: 0
        max: 3
      scaledownPeriod: 300
      maxRetries: 5
      scalingMetric: # requestRate and concurrency are mutually exclusive
        requestRate:
          granularity: 1m
          targetValue: 100
          window: 1m

    helm:
      repository: "zero101010/api-rest-go"
      branchName: "keda-helm"
      grpc: true
      disableIngressHost: false
      overrideDefaultIpWhitelist: true
      chart:
        name: 'goodrx-app'
        valueFiles:
          - 'sysops/helm/common.yaml'
          - 'sysops/helm/lfc/service/app.yaml'
      docker:
        defaultTag: "main"
        app:
          dockerfilePath: "sysops/dockerfiles/app.Dockerfile"
          ports:
            - 8080
          env:
            COMPONENT: "app"
            ENV: "lifecycle"
            PORT: "8080"
